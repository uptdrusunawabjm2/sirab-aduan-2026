<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Data Aduan</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<script src="https://cdn.tailwindcss.com"></script>

<style>
.watermark{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
  z-index:0;
}
.watermark span{
  font-size:8vw;
  font-weight:900;
  color:rgba(255,255,255,0.04);
  transform:rotate(-25deg);
  user-select:none;
  white-space:nowrap;
}
</style>
</head>

<body class="bg-slate-950 text-white min-h-screen p-3 md:p-4 relative">

<div class="watermark"><span>DATA ADUAN</span></div>

<div class="max-w-7xl mx-auto space-y-4 relative z-10" id="wrap">

  <div class="text-center space-y-1">
    <h1 class="text-xl md:text-3xl font-bold">Daftar Layanan Pengaduan</h1>
    <p class="text-slate-400 text-xs md:text-sm">monitoring pengaduan rusunawa</p>
    <p id="lastUpdate" class="text-[11px] text-slate-500"></p>
  </div>

  <!-- CARD -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
    <div class="bg-slate-900 border border-slate-800 rounded-xl p-4">
      <div class="text-slate-400 text-sm">Total Aduan</div>
      <div id="rTotal" class="text-2xl font-bold">0</div>
    </div>
    <div class="bg-yellow-500/20 border border-yellow-500 rounded-xl p-4">
      <div class="text-yellow-300 text-sm">Pending</div>
      <div id="rPending" class="text-2xl font-bold text-yellow-400">0</div>
    </div>
    <div class="bg-blue-600/20 border border-blue-600 rounded-xl p-4">
      <div class="text-blue-300 text-sm">Diperiksa</div>
      <div id="rPeriksa" class="text-2xl font-bold text-blue-400">0</div>
    </div>
    <div class="bg-green-600/20 border border-green-600 rounded-xl p-4">
      <div class="text-green-300 text-sm">Selesai</div>
      <div id="rSelesai" class="text-2xl font-bold text-green-400">0</div>
    </div>
  </div>

  <!-- FILTER -->
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2">
    <input id="search" oninput="applyFilter()" placeholder="üîç Cari data..."
      class="p-3 rounded-xl bg-slate-800 border border-slate-700 text-sm">

    <select id="filterRusun" onchange="applyFilter()"
      class="p-3 rounded-xl bg-slate-800 border border-slate-700 text-sm">
      <option value="">Semua Rusunawa</option>
    </select>

    <select id="filterStatus" onchange="applyFilter()"
      class="p-3 rounded-xl bg-slate-800 border border-slate-700 text-sm">
      <option value="">Semua Status</option>
      <option value="PENDING">PENDING</option>
      <option value="DIPERIKSA">DIPERIKSA</option>
      <option value="SELESAI">SELESAI</option>
    </select>

    <input id="fromDate" type="date" onchange="applyFilter()"
      class="p-3 rounded-xl bg-slate-800 border border-slate-700 text-sm">

    <input id="toDate" type="date" onchange="applyFilter()"
      class="p-3 rounded-xl bg-slate-800 border border-slate-700 text-sm">

    <button onclick="resetFilter()"
      class="sm:col-span-2 md:col-span-3 lg:col-span-5 bg-red-600/20 border border-red-600 text-red-400 p-3 rounded-xl text-sm hover:bg-red-600 hover:text-white transition">
      üîÑ Reset Filter
    </button>
  </div>

  <div id="tableBox" class="bg-slate-900 border border-slate-800 rounded-xl overflow-auto max-h-[65vh]">
    <table class="w-full text-xs md:text-sm" id="table"></table>
  </div>

  <div class="flex flex-wrap items-center justify-center gap-2 text-xs md:text-sm">
    <button onclick="prevPage()" class="px-3 py-1.5 rounded bg-slate-800 border border-slate-700">‚èÆ Prev</button>
    <div id="pages" class="flex flex-wrap gap-1"></div>
    <button onclick="nextPage()" class="px-3 py-1.5 rounded bg-slate-800 border border-slate-700">Next ‚è≠</button>
  </div>

</div>

<script>
/* ====== BAGIAN INI TIDAK DIUBAH, HANYA FUNGSI FORMAT JANJI TEMU ====== */

function fmtHariJamSheet(v){
  if(!v) return "";

  const raw = String(v).trim();

  // ambil tanggal di awal (sebelum spasi)
  const parts = raw.split(" ");
  const d = new Date(parts[0]);

  if(isNaN(d)) return raw;

  const tanggal = d.toLocaleDateString("id-ID",{
    weekday:"long",
    day:"2-digit",
    month:"long",
    year:"numeric"
  });

  // ambil jam persis seperti di sheet
  const jam = raw.replace(parts[0], "").trim();

  return jam ? tanggal + " " + jam : tanggal;
}
</script>

</body>
</html>
