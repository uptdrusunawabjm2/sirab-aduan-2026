<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Tracking Aduan Rusunawa</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>

<style>
body{background:radial-gradient(circle at top,#0f172a,#020617);}
.card{backdrop-filter:blur(12px);background:linear-gradient(145deg,rgba(30,41,59,.92),rgba(15,23,42,.92));}
.input{width:100%;padding:14px;font-size:16px;background:#020617;border:1px solid #334155;border-radius:14px;color:white;}
</style>
</head>

<body class="text-white min-h-screen flex items-center justify-center p-4">

<div class="w-full max-w-xl card border border-slate-800 rounded-2xl shadow-2xl p-6 space-y-5">

<h1 class="text-xl md:text-2xl font-bold text-center">Tracking Aduan Rusunawa</h1>
<p class="text-center text-slate-400 text-sm">Pantau status penanganan aduan Anda secara realtime</p>

<div class="flex gap-2">
  <input id="ticketInput" placeholder="Masukkan Submission ID" class="input">
  <button onclick="cek()" class="bg-blue-600 hover:bg-blue-700 px-4 rounded-xl font-semibold">Cek</button>
</div>

<div id="hasil" class="text-sm"></div>

</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbwyiBhW4WoSehZ86jYH8CqW_k-GgTvVJ0QOkc1UT_4kXfY5cJZ0xGsMujELidj76TIcUg/exec";

/* ================= AUTO TRACK DARI URL ================= */
window.onload = () => {
  const p = new URLSearchParams(window.location.search);
  const t = p.get("ticket");
  if(t){
    ticketInput.value = t;
    cek();
  }
};
/* ======================================================= */

async function cek(){
  const id = ticketInput.value.trim();
  if(!id){
    hasil.innerHTML = "<div class='text-red-400'>Masukkan nomor tiket</div>";
    return;
  }

  hasil.innerHTML = "üîÑ Memuat data...";

  const r = await fetch(API + "?action=track&id=" + encodeURIComponent(id));
  const j = await r.json();

  if(!j.found){
    hasil.innerHTML = "<div class='text-red-400'>‚ùå Data tidak ditemukan</div>";
    return;
  }

  const h = j.header;
  const d = j.data;

  let html = "<div class='bg-slate-900 border border-slate-700 rounded-xl p-4 space-y-2'>";
  h.forEach((k,i)=>{
    if(d[i]) html += `<div><b>${k}</b><br><span class="text-slate-300">${d[i]}</span></div>`;
  });
  html += "</div>";

  hasil.innerHTML = html;
}
</script>
</body>
</html>
