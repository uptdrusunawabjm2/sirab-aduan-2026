<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Pengaduan</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-950 text-white p-6">

<h1 class="text-2xl font-bold mb-4">Dashboard Pengaduan</h1>
<table class="w-full text-sm" id="t"></table>

<script>
if(!sessionStorage.getItem("admin")) location.href="login.html";

const API = "ISI_URL_APPS_SCRIPT";
const KEY = "12345"; // samakan dengan ADMIN_PASS

async function load(){
  const r = await fetch(`${API}?action=all&key=${KEY}`);
  const j = await r.json();
  let h="<tr class='bg-slate-800'>";
  j.header.forEach(x=>h+=`<th class='p-2'>${x}</th>`);
  h+="<th>Aksi</th></tr>";

  j.data.forEach(r=>{
    h+="<tr class='border-b border-slate-800'>";
    r.forEach(x=>h+=`<td class='p-2'>${x||""}</td>`);
    h+=`<td><button onclick="edit('${r[0]}')" class="text-blue-400">Edit</button></td></tr>`;
  });

  t.innerHTML=h;
}

function edit(id){
  const s = prompt("Status (Pending/Diproses/Selesai)");
  const c = prompt("Catatan penanganan");
  const f = prompt("Link foto hasil");

  fetch(API,{
    method:"POST",
    body:JSON.stringify({
      action:"update",
      key:KEY,
      id:id,
      status:s,
      catatan:c,
      foto:f
    })
  }).then(()=>load());
}

load();
</script>
</body>
</html>
